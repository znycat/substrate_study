"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ed25519Sign = void 0;
const tslib_1 = require("tslib");
const tweetnacl_1 = tslib_1.__importDefault(require("tweetnacl"));
const util_1 = require("@polkadot/util");
const wasm_crypto_1 = require("@polkadot/wasm-crypto");
/**
 * @name ed25519Sign
 * @summary Signs a message using the supplied secretKey
 * @description
 * Returns message signature of `message`, using the `secretKey`.
 * @example
 * <BR>
 *
 * ```javascript
 * import { ed25519Sign } from '@polkadot/util-crypto';
 *
 * ed25519Sign([...], [...]); // => [...]
 * ```
 */
function ed25519Sign(message, { publicKey, secretKey }, onlyJs) {
    if (!secretKey) {
        throw new Error('Expected a valid secretKey');
    }
    const messageU8a = (0, util_1.u8aToU8a)(message);
    return !onlyJs && (0, wasm_crypto_1.isReady)()
        ? (0, wasm_crypto_1.ed25519Sign)(publicKey, secretKey.subarray(0, 32), messageU8a)
        : tweetnacl_1.default.sign.detached(messageU8a, secretKey);
}
exports.ed25519Sign = ed25519Sign;
